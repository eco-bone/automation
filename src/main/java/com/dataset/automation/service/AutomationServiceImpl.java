package com.dataset.automation.service;

import com.dataset.automation.dao.DatasetRepo;
import com.dataset.automation.dao.ProfessionsRepo;
import com.dataset.automation.dto.BotRequest;
import com.dataset.automation.dto.DatasetDto;
import com.dataset.automation.model.DatasetObject;
import com.dataset.automation.model.Profession;
import jakarta.servlet.http.HttpServletResponseWrapper;
import lombok.extern.slf4j.Slf4j;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.data.domain.Sort;
import org.springframework.stereotype.Service;
import org.supercsv.io.CsvBeanWriter;
import org.supercsv.io.ICsvBeanWriter;
import org.supercsv.prefs.CsvPreference;

import java.io.IOException;
import java.text.DateFormat;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.List;

@Service
@Slf4j
public class AutomationServiceImpl implements AutomationService {

    @Autowired
    private final BotService botService;

    @Autowired
    private final DatasetRepo datasetRepo;

    @Autowired
    private final ProfessionsRepo profRepo;

    @Autowired
    private final CrudService datasetService;

    @Autowired
    private final OpenAIChatService apiService;

    @Autowired
    private final OpenAIChatService2 apiService2;

    public AutomationServiceImpl(BotService botService, DatasetRepo datasetRepo,
                                 ProfessionsRepo profRepo, CrudService datasetService, OpenAIChatService apiService, OpenAIChatService2 apiService2) {
        this.botService = botService;
        this.datasetRepo = datasetRepo;
        this.profRepo = profRepo;
        this.datasetService = datasetService;
        this.apiService = apiService;
        this.apiService2 = apiService2;
    }


    public void createDataset(int n) {
        String getOriginalPrompt = "";
        String paraphrasePrompt = "\n";
        for (int i = 0; i < n; i++) {
            Profession prof = profRepo.findById(i).orElse(null);

            if (prof.getProfession() != null) {
                log.info("Profession found: " + prof.getProfession() + ".........");
                BotRequest request1 = new BotRequest();
                request1.setMessage(getOriginalPrompt + prof.getProfession());
                DatasetObject datasetObject = new DatasetObject();

                datasetObject.setOriginalId(datasetService.
                        storeOriginalParagraph(botService.getOutput(request1)));

                log.info("Original Paragraph Created for profession : " + prof.getProfession());

                BotRequest request2 = new BotRequest();

                request2.setMessage(paraphrasePrompt + datasetService.
                        retrieveOriginalParagraph(datasetObject.getOriginalId()));

                datasetObject.setParaphraseId(datasetService.
                        storeParaphrasedParagraph(botService.getOutput(request2)));

                log.info("Paraphrase Created for profession : " + prof.getProfession());
                datasetRepo.save(datasetObject);
                log.info("NUMBER OF PROFESSIONS ITERATED: " + i);
            } else {
                log.info("Profession not found.........");
            }
        }
        log.info("DATASET CREATION COMPLETE. TO USE DATASET, EXPORT TO CSV FILE.");
    }

    public void createDataset2(int num) {
        long startTime = System.currentTimeMillis();
        int x = 0;
        log.info("Dataset Creation process started....");

        // RAN TILL 220

        String[] professions1 = {"Software Engineer",
                "Data Scientist",
                "Network Administrator",
                "Database Administrator",
                "Web Developer",
                "System Administrator",
                "IT Manager",
                "Cybersecurity Analyst",
                "Business Intelligence Analyst",
                "Cloud Architect",
                "DevOps Engineer",
                "Machine Learning Engineer",
                "AI Engineer",
                "Game Developer",
                "Mobile App Developer",
                "Quality Assurance Engineer",
                "Front-End Developer",
                "Back-End Developer",
                "Full-Stack Developer",
                "UI/UX Designer",
                "Product Manager",
                "Project Manager",
                "Technical Writer",
                "Scrum Master",
                "Systems Analyst",
                "Network Engineer",
                "IT Consultant",
                "Computer Programmer",
                "Java Developer",
                "Python Developer",
                "C++ Developer",
                "Ruby Developer",
                "PHP Developer",
                "Go Developer",
                "Swift Developer",
                "Kotlin Developer",
                "Scala Developer",
                "React Developer",
                "Angular Developer",
                "Vue.js Developer",
                "Node.js Developer",
                "Django Developer",
                "Flask Developer",
                "Spring Developer",
                "ASP.NET Developer",
                "Ruby on Rails Developer",
                "Laravel Developer",
                "Express.js Developer",
                "MongoDB Developer",
                "SQL Developer",
                "NoSQL Developer",
                "Embedded Systems Engineer",
                "Hardware Engineer",
                "Firmware Engineer",
                "Network Security Engineer",
                "Systems Security Analyst",
                "Penetration Tester",
                "Security Consultant",
                "Security Architect",
                "Incident Responder",
                "Digital Forensic Analyst",
                "Malware Analyst",
                "Security Operations Center (SOC) Analyst",
                "IT Auditor",
                "Compliance Analyst",
                "Business Continuity Analyst",
                "Big Data Engineer",
                "Big Data Analyst",
                "Data Engineer",
                "Data Analyst",
                "Data Architect",
                "Data Warehouse Developer",
                "ETL Developer",
                "Business Analyst",
                "Quantitative Analyst",
                "Statistician",
                "Bioinformatics Analyst",
                "Geospatial Analyst",
                "Operations Analyst",
                "Network Operations Center (NOC) Technician",
                "Help Desk Technician",
                "Desktop Support Specialist",
                "IT Support Specialist",
                "Technical Support Engineer",
                "Customer Support Engineer",
                "IT Trainer",
                "Instructional Designer",
                "UX Researcher",
                "Content Strategist",
                "SEO Specialist",
                "Digital Marketing Specialist",
                "Social Media Manager",
                "E-commerce Specialist",
                "Product Owner",
                "Agile Coach",
                "Release Manager",
                "Build Engineer",
                "Configuration Manager",
                "Test Automation Engineer",
                "ITIL Service Manager",
                "IT Service Desk Manager",
                "Data Center Manager",
                "Infrastructure Architect",
                "Middleware Administrator",
                "Storage Administrator",
                "Virtualization Engineer",
                "Linux Administrator",
                "Windows Administrator",
                "Unix Administrator",
                "Mainframe Administrator",
                "Wireless Communications Engineer",
                "Telecommunications Engineer",
                "Satellite Communications Engineer",
                "RF Engineer",
                "Optical Communications Engineer",
                "IT Procurement Specialist",
                "IT Vendor Manager",
                "Business Systems Analyst",
                "Enterprise Architect",
                "Solution Architect",
                "IT Risk Analyst",
                "IT Compliance Manager",
                "Data Privacy Officer",
                "Blockchain Developer",
                "Smart Contract Developer",
                "Cryptocurrency Analyst",
                "Quantum Computing Engineer",
                "Augmented Reality (AR) Developer",
                "Virtual Reality (VR) Developer",
                "Human-Computer Interaction (HCI) Specialist",
                "Digital Transformation Manager",
                "Automation Engineer",
                "Robotics Engineer",
                "IoT Developer",
                "Embedded Software Engineer",
                "Linux Kernel Developer",
                "Wireless Network Engineer",
                "Telecom Project Manager",
                "System Integration Engineer",
                "IT Business Analyst",
                "Enterprise Resource Planning (ERP) Consultant",
                "SAP Consultant",
                "Microsoft Dynamics Consultant",
                "Salesforce Developer",
                "Health IT Specialist",
                "Telehealth Specialist",
                "Biomedical Engineer",
                "Clinical Informatics Specialist",
                "Bioinformatics Scientist",
                "Genomic Data Analyst",
                "Health Informatics Manager",
                "IT for Development (ICT4D) Specialist",
                "GIS Analyst",
                "Geographic Information System (GIS) Developer",
                "Remote Sensing Specialist",
                "Renewable Energy Systems Engineer",
                "Environmental Data Analyst",
                "Geotechnical Engineer",
                "GIS Database Administrator",
                "Geospatial Software Developer",
                "Sustainable Design Engineer",
                "CAD Technician",
                "Biostatistician",
                "Clinical Data Manager",
                "Medical Imaging Engineer",
                "Healthcare IT Project Manager",
                "Health IT Security Specialist",
                "Health IT Compliance Analyst",
                "Clinical Systems Analyst",
                "Clinical Workflow Analyst",
                "Biomedical Equipment Technician",
                "Clinical Research Coordinator",
                "Bioinformatics Software Developer",
                "Health IT Trainer",
                "Telemedicine Engineer",
                "Computer Vision Engineer",
                "Speech Recognition Engineer",
                "Natural Language Processing (NLP) Engineer",
                "Knowledge Engineer",
                "Information Retrieval Specialist",
                "Data Privacy Analyst",
                "Data Governance Specialist",
                "Data Steward",
                "IT Asset Manager",
                "IT Procurement Analyst",
                "IT Contracts Manager",
                "Vendor Relationship Manager",
                "Business Intelligence Developer",
                "Data Mining Specialist",
                "Statistical Programmer",
                "Mathematical Modeler",
                "Operations Research Analyst",
                "Supply Chain Analyst",
                "Logistics Analyst",
                "Procurement Specialist",
                "Inventory Analyst",
                "Demand Planner",
                "Quality Control Analyst",
                "Six Sigma Black Belt",
                "Lean Six Sigma Consultant",
                "Continuous Improvement Manager",
                "Agile Project Manager",
                "Product Marketing Manager",
                "Technical Recruiter",
                "IT Sourcing Specialist",
                "Digital Content Strategist",
                "API Developer",
                "Microservices Architect",
                "Identity and Access Management (IAM) Engineer",
                "Authentication Engineer",
                "Authorization Engineer",
                "Biometric Engineer",
                "Identity Management Specialist",
                "Access Control Specialist",
                "Identity Governance Specialist",
                "Data Governance Analyst",
                "Data Management Specialist",
                "Master Data Management (MDM) Specialist",
                "Metadata Management Specialist",
                "Data Quality Analyst",
                "Data Migration Specialist",
                "Data Integration Specialist",
                "API Integration Engineer",
                "API Security Specialist",
                "API Gateway Administrator",
                "API Product Manager",
                "IT Change Manager",
                "Change Management Analyst",
                "Change Management Consultant",
                "Change Management Specialist",
                "Change Facilitator",
                "Configuration Management Analyst",
                "Configuration Management Specialist",
                "Continuous Integration (CI) Engineer",
                "Continuous Deployment (CD) Engineer",
                "Release Engineer",
                "Release Coordinator",
                "Release Analyst",
                "Release Consultant",
                "Release Specialist",
                "Build and Release Engineer",
                "Build and Release Manager",
                "Build and Release Specialist",
                "Build and Release Coordinator",
                "Build and Release Consultant",
                "Build and Release Analyst",
                "Technical Evangelist",
                "API Evangelist",
                "Cloud Evangelist",
                "Blockchain Evangelist",
                "DevOps Evangelist",
                "Agile Evangelist",
                "Data Evangelist",
                "IoT Evangelist",
                "Digital Transformation Evangelist",
                "Cybersecurity Evangelist",
                "Machine Learning Evangelist",
                "Artificial Intelligence (AI) Evangelist",
                "Robotics Evangelist",
                "Augmented Reality (AR) Evangelist",
                "Virtual Reality (VR) Evangelist",
                "5G Engineer",
                "Edge Computing Engineer",
                "Serverless Computing Engineer",
                "Microservices Engineer",
                "Containerization Engineer",
                "Chatbot Developer",
                "Conversational AI Engineer",
                "Natural Language Understanding (NLU) Engineer",
                "Quantum Computing Researcher",
                "Quantum Algorithm Developer",
                "Quantum Information Scientist",
                "Quantum Software Engineer",
                "Quantum Hardware Engineer",
                "Quantum Cryptography Engineer",
                "Quantum Communication Engineer",
                "Quantum Networking Engineer",
                "Quantum Sensing Engineer",
                "Quantum Metrology Engineer",
                "Quantum Optics Engineer",
                "Quantum Materials Scientist",
                "Quantum Physicist",
                "Quantum Chemist",
                "Quantum Biologist",
                "Quantum Psychologist",
                "Quantum Economist",
                "Quantum Ethicist",
                "Quantum Lawyer",
                "Quantum Educator",
                "Quantum Philosopher",
                "Quantum Artist",
                "Quantum Poet",
                "Quantum Journalist",
                "Quantum Historian",
                "Quantum Futurist",
                "Quantum Engineer",
                "Quantum Technologist",
                "Quantum Entrepreneur",
                "Quantum Investor",
                "Quantum Philanthropist",
                "Quantum Explorer",
                "Quantum Communicator",
                "Quantum Diplomat",
                "Quantum Ambassador",
                "Quantum Athlete",
                "Quantum Chef",
                "Quantum Gardener",
                "Quantum Fashion Designer",
                "Quantum Architect",
                "Quantum Urban Planner",
                "Quantum Sociologist",
                "Quantum Psychologist",
                "Quantum Biotechnologist",
                "Quantum Musician",
                "Quantum Filmmaker",
                "Quantum Game Developer",
                "Quantum Entertainer",
                "Quantum Traveler",
                "Quantum Tour Guide",
                "Quantum Storyteller",
                "Quantum Librarian",
                "Quantum Therapist",
                "Quantum Healer",
                "Quantum Fitness Trainer",
                "Quantum Nutritionist",
                "Quantum Life Coach",
                "Quantum Spiritual Guide",
                "Quantum Time Traveler",
                "Quantum Alchemist",
                "Quantum Magician",
                "Quantum Oracle",
                "Quantum Dream Interpreter",
                "Quantum Astrologer",
                "Quantum Tarot Reader",
                "Quantum Numerologist",
                "Quantum Crystal Healer",
                "Quantum Feng Shui Consultant",
                "Quantum Medium",
                "Quantum Paranormal Investigator",
                "Quantum UFOologist",
                "Quantum Cryptozoologist",
                "Quantum Ghost Hunter",
                "Quantum Exorcist",
                "Quantum Psychic Detective",
                "Quantum Time Detective",
                "Quantum Archaeologist",
                "Quantum Paleontologist",
                "Quantum Biographer",
                "Quantum Historian",
                "Quantum Anthropologist",
                "Quantum Sociocultural Analyst",
                "Quantum Linguist",
                "Quantum Ethnographer",
                "Quantum Mythologist",
                "Quantum Archaeoastronomer",
                "Quantum Geologist",
                "Quantum Meteorologist",
                "Quantum Oceanographer",
                "Quantum Ecologist",
                "Quantum Botanist",
                "Quantum Zoologist",
                "Quantum Entomologist",
                "Quantum Ornithologist",
                "Quantum Marine Biologist",
                "Quantum Ecophysiologist",
                "Quantum Neuroscientist",
                "Quantum Psychologist",
                "Quantum Psychophysiologist",
                "Quantum Psychoneuroimmunologist",
                "Quantum Neurophilosopher",
                "Quantum Neuroethicist",
                "Quantum Neuroaesthetist",
                "Quantum Neuroeducator",
                "Quantum Neuromarketer",
                "Quantum Neuromusician",
                "Quantum Neuroartist",
                "Quantum Neurorobotics Engineer",
                "Quantum Neuromorphic Engineer",
                "Quantum Neuromodulation Specialist",
                "Quantum Neuroinformatics Specialist",
                "Quantum Neurotherapist",
                "Quantum Neuropsychotherapist",
                "Quantum Neuropsychiatrist",
                "Quantum Neuropediatrician",
                "Quantum Neurogeriatrician",
                "Quantum Neurooncologist",
                "Quantum Neuroendocrinologist",
                "Quantum Neuropharmacologist",
                "Quantum Neurotoxicologist",
                "Quantum Neuroepidemiologist",
                "Quantum Neuroethologist",
                "Quantum Neurobiologist",
                "Quantum Neurochemist",
                "Quantum Neurogeneticist",
                "Quantum Neuroimmunologist",
                "Quantum Neuroinfectiologist",
                "Quantum Neurointensivist",
                "Quantum Neurologist",
                "Quantum Neuropathologist",
                "Quantum Neurophysiologist",
                "Quantum Neuropsychologist",
                "Quantum Neuroradiologist",
                "Quantum Neurorobotics Specialist",
                "Quantum Neuroscientist",
                "Quantum Neurosurgeon",
                "Quantum Neurotechnologist",
                "Quantum Neurotherapist",
                "Quantum Neurotoxicologist",
                "Quantum Neurovirologist",
                "Quantum Neurozoologist",
                "Quantum Cognitive Scientist",
                "Quantum Behavioral Scientist",
                "Quantum Social Scientist",
                "Quantum Political Scientist",
                "Quantum Economic Scientist",
                "Quantum Environmental Scientist",
                "Quantum Climate Scientist",
                "Quantum Planetary Scientist",
                "Quantum Astronomer",
                "Quantum Astrophysicist",
                "Quantum Cosmologist",
                "Quantum String Theorist",
                "Quantum Theoretical Physicist",
                "Quantum Experimental Physicist",
                "Quantum Particle Physicist",
                "Quantum Nuclear Physicist",
                "Quantum Condensed Matter Physicist",
                "Quantum Atomic Physicist",
                "Quantum Optical Physicist",
                "Quantum Quantum Physicist",
                "Quantum Plasma Physicist",
                "Quantum Fluid Dynamicist",
                "Quantum Solid State Physicist",
                "Quantum Biophysicist",
                "Quantum Chemist",
                "Quantum Physicochemist",
                "Quantum Geochemist",
                "Quantum Analytical Chemist",
                "Quantum Inorganic Chemist",
                "Quantum Organic Chemist",
                "Quantum Physical Chemist"};

        String[] professions2 = {"General Manager",
                "Operations Manager",
                "Project Manager",
                "Human Resources Manager",
                "Financial Manager",
                "Marketing Manager",
                "Sales Manager",
                "Supply Chain Manager",
                "IT Manager",
                "Customer Service Manager",
                "Quality Assurance Manager",
                "Risk Manager",
                "Business Development Manager",
                "Product Manager",
                "Program Manager",
                "Account Manager",
                "Public Relations Manager",
                "Event Manager",
                "Facilities Manager",
                "Logistics Manager",
                "Production Manager",
                "Procurement Manager",
                "Brand Manager",
                "Retail Manager",
                "Hotel Manager",
                "Restaurant Manager",
                "Legal Manager",
                "Hospital Administrator",
                "Education Administrator",
                "Nonprofit Manager",
                "Government Administrator",
                "Information Security Manager",
                "Change Management Consultant",
                "Strategic Planner",
                "Management Analyst",
                "Financial Analyst",
                "Data Analyst",
                "Business Intelligence Analyst",
                "Healthcare Administrator",
                "Property Manager",
                "Real Estate Manager",
                "Corporate Trainer",
                "Compliance Manager",
                "Environmental Manager",
                "Energy Manager",
                "Insurance Manager",
                "Customer Success Manager",
                "Investment Manager",
                "Public Administration Manager",
                "Social Media Manager",
                "Corporate Communications Manager",
                "Corporate Social Responsibility Manager",
                "Talent Acquisition Manager",
                "Learning and Development Manager",
                "Community Manager",
                "Risk Analyst",
                "Corporate Counsel",
                "Business Process Manager",
                "Program Coordinator",
                "Operations Coordinator",
                "Event Coordinator",
                "Logistics Coordinator",
                "Training Coordinator",
                "Administrative Manager",
                "Office Manager",
                "Executive Assistant",
                "Administrative Assistant",
                "Financial Planner",
                "Budget Analyst",
                "Audit Manager",
                "Internal Auditor",
                "External Auditor",
                "Compliance Analyst",
                "Inventory Manager",
                "Warehouse Manager",
                "Transportation Manager",
                "Customer Experience Manager",
                "Customer Relationship Manager",
                "Vendor Manager",
                "Client Services Manager",
                "Legal Counsel",
                "Intellectual Property Manager",
                "Media Manager",
                "Brand Ambassador",
                "Retail Buyer",
                "Supply Chain Analyst",
                "Data Scientist",
                "Business Development Analyst",
                "Retail Merchandiser",
                "E-commerce Manager",
                "Social Media Coordinator",
                "Market Research Analyst",
                "Public Affairs Manager",
                "Regulatory Affairs Manager",
                "Risk Management Analyst",
                "Sustainability Manager",
                "Corporate Trainer",
                "Corporate Recruiter",
                "Strategic Planning Analyst",
                "Inventory Analyst",
                "Business Systems Analyst",
                "IT Project Manager",
                "Business Continuity Manager",
                "Product Owner",
                "Customer Support Manager",
                "Market Development Manager",
                "Channel Manager",
                "Accounting Manager",
                "Tax Manager",
                "Finance Director",
                "Merchandising Manager",
                "Online Community Manager",
                "Employee Relations Manager",
                "Occupational Health and Safety Manager",
                "Business Intelligence Manager",
                "Data Manager",
                "Information Systems Manager",
                "Clinical Trial Manager",
                "Pharmaceutical Project Manager",
                "Quality Control Manager",
                "Customer Insights Manager",
                "International Business Manager",
                "Legal Analyst",
                "Policy Analyst",
                "Trade Show Coordinator",
                "Marketing Coordinator",
                "Supply Chain Coordinator",
                "Quality Assurance Analyst",
                "Project Coordinator",
                "Financial Coordinator",
                "Vendor Coordinator",
                "Client Services Coordinator",
                "Training and Development Coordinator",
                "Administrative Coordinator",
                "Financial Advisor",
                "Investment Advisor",
                "Budget Coordinator",
                "Audit Coordinator",
                "Compliance Coordinator",
                "Event Planner",
                "Logistics Planner",
                "Training Planner",
                "Marketing Planner",
                "Real Estate Developer",
                "Retail Developer",
                "Energy Analyst",
                "Insurance Analyst",
                "Customer Success Coordinator",
                "Inventory Coordinator",
                "Warehouse Coordinator",
                "Transportation Coordinator",
                "Customer Experience Coordinator",
                "Vendor Coordinator",
                "Client Services Coordinator",
                "Legal Coordinator",
                "Media Coordinator",
                "Retail Merchandising Coordinator",
                "E-commerce Coordinator",
                "Social Media Planner",
                "Market Research Coordinator",
                "Public Affairs Coordinator",
                "Regulatory Affairs Coordinator",
                "Sustainability Coordinator",
                "Occupational Health and Safety Coordinator",
                "Clinical Trial Coordinator",
                "Pharmaceutical Project Coordinator",
                "Quality Control Coordinator",
                "Customer Insights Coordinator",
                "International Business Coordinator",
                "Legal Consultant",
                "Policy Consultant",
                "Trade Show Planner",
                "Marketing Consultant",
                "Supply Chain Consultant",
                "Quality Assurance Consultant",
                "Project Consultant",
                "Financial Consultant",
                "Vendor Consultant",
                "Client Services Consultant",
                "Training and Development Consultant",
                "Administrative Consultant",
                "Financial Analyst",
                "Investment Analyst",
                "Budget Consultant",
                "Audit Consultant",
                "Compliance Consultant",
                "Event Consultant",
                "Logistics Consultant",
                "Training Consultant",
                "Marketing Consultant",
                "Real Estate Consultant",
                "Retail Consultant",
                "Energy Consultant",
                "Insurance Consultant",
                "Customer Success Consultant",
                "Inventory Consultant",
                "Warehouse Consultant",
                "Transportation Consultant",
                "Customer Experience Consultant",
                "Vendor Consultant",
                "Client Services Consultant",
                "Legal Consultant",
                "Media Consultant",
                "Retail Merchandising Consultant",
                "E-commerce Consultant",
                "Social Media Consultant",
                "Market Research Consultant",
                "Public Affairs Consultant",
                "Regulatory Affairs Consultant",
                "Sustainability Consultant",
                "Occupational Health and Safety Consultant",
                "Clinical Trial Consultant",
                "Pharmaceutical Project Consultant",
                "Quality Control Consultant",
                "Customer Insights Consultant",
                "International Business Consultant",
                "Employee Development Manager",
                "Employee Training Manager",
                "Organizational Development Manager",
                "Compensation and Benefits Manager",
                "Health and Safety Manager",
                "Facilities Coordinator",
                "Occupational Health and Safety Consultant",
                "Employee Development Coordinator",
                "Employee Training Coordinator",
                "Organizational Development Coordinator",
                "Compensation and Benefits Coordinator",
                "Health and Safety Coordinator",
                "Facilities Consultant",
                "Occupational Health and Safety Consultant",
                "Human Resources Coordinator",
                "Human Resources Consultant",
                "Human Resources Analyst",
                "Employee Relations Coordinator",
                "Employee Relations Consultant",
                "Talent Acquisition Coordinator",
                "Talent Acquisition Consultant",
                "Learning and Development Coordinator",
                "Learning and Development Consultant",
                "Recruitment Coordinator",
                "Recruitment Consultant",
                "Training and Development Coordinator",
                "Training and Development Consultant",
                "Compensation and Benefits Analyst",
                "Health and Safety Analyst",
                "Employee Development Analyst",
                "Organizational Development Analyst",
                "Human Resources Administrator",
                "Talent Management Coordinator",
                "Talent Management Consultant",
                "Performance Management Coordinator",
                "Performance Management Consultant",
                "Change Management Coordinator",
                "Change Management Consultant",
                "Diversity and Inclusion Coordinator",
                "Diversity and Inclusion Consultant",
                "Employee Engagement Coordinator",
                "Employee Engagement Consultant",
                "Succession Planning Coordinator",
                "Succession Planning Consultant",
                "Workforce Planning Coordinator",
                "Workforce Planning Consultant",
                "Benefits Coordinator",
                "Benefits Consultant",
                "HR Generalist",
                "HR Specialist",
                "Compensation Analyst",
                "Benefits Analyst",
                "Training and Development Analyst",
                "Recruitment Analyst",
                "Workforce Planning Analyst",
                "Employee Engagement Analyst",
                "Talent Management Analyst",
                "Performance Management Analyst",
                "Organizational Development Specialist",
                "Talent Acquisition Specialist",
                "Recruitment Specialist",
                "Training and Development Specialist",
                "Compensation Specialist",
                "Benefits Specialist",
                "Employee Engagement Specialist",
                "Workforce Planning Specialist",
                "Talent Management Specialist",
                "Performance Management Specialist",
                "Change Management Specialist",
                "Diversity and Inclusion Specialist",
                "Succession Planning Specialist",
                "Workforce Planning Specialist",
                "Benefits Administrator",
                "Compensation Administrator",
                "Training and Development Administrator",
                "Recruitment Administrator",
                "Employee Engagement Administrator",
                "Talent Management Administrator",
                "Performance Management Administrator",
                "Change Management Administrator",
                "Diversity and Inclusion Administrator",
                "Succession Planning Administrator",
                "Workforce Planning Administrator",
                "Training Coordinator",
                "Training Manager",
                "Training Specialist",
                "Training Administrator",
                "Education Coordinator",
                "Education Manager",
                "Education Specialist",
                "Education Administrator",
                "Learning and Development Coordinator",
                "Learning and Development Manager",
                "Learning and Development Specialist",
                "Learning and Development Administrator",
                "Leadership Development Coordinator",
                "Leadership Development Manager",
                "Leadership Development Specialist",
                "Leadership Development Administrator",
                "Career Development Coordinator",
                "Career Development Manager",
                "Career Development Specialist",
                "Career Development Administrator",
                "Organizational Development Coordinator",
                "Organizational Development Manager",
                "Organizational Development Specialist",
                "Organizational Development Administrator",
                "Change Management Coordinator",
                "Change Management Manager",
                "Change Management Specialist",
                "Change Management Administrator",
                "Employee Engagement Coordinator",
                "Employee Engagement Manager",
                "Employee Engagement Specialist",
                "Employee Engagement Administrator",
                "Talent Management Coordinator",
                "Talent Management Manager",
                "Talent Management Specialist",
                "Talent Management Administrator",
                "Performance Management Coordinator",
                "Performance Management Manager",
                "Performance Management Specialist",
                "Performance Management Administrator",
                "Compensation and Benefits Coordinator",
                "Compensation and Benefits Manager",
                "Compensation and Benefits Specialist",
                "Compensation and Benefits Administrator",
                "Workforce Planning Coordinator",
                "Workforce Planning Manager",
                "Workforce Planning Specialist",
                "Workforce Planning Administrator",
                "Diversity and Inclusion Coordinator",
                "Diversity and Inclusion Manager",
                "Diversity and Inclusion Specialist",
                "Diversity and Inclusion Administrator",
                "Succession Planning Coordinator",
                "Succession Planning Manager",
                "Succession Planning Specialist",
                "Succession Planning Administrator",
                "Recruitment Coordinator",
                "Recruitment Manager",
                "Recruitment Specialist",
                "Recruitment Administrator",
                "HR Coordinator",
                "HR Manager",
                "HR Specialist",
                "HR Administrator",
                "Employee Relations Coordinator",
                "Employee Relations Manager",
                "Employee Relations Specialist",
                "Employee Relations Administrator",
                "Talent Acquisition Coordinator",
                "Talent Acquisition Manager",
                "Talent Acquisition Specialist",
                "Talent Acquisition Administrator",
                "HR Business Partner",
                "HR Consultant",
                "HR Analyst",
                "People Operations Coordinator",
                "People Operations Manager",
                "People Operations Specialist",
                "People Operations Administrator",
                "Chief Human Resources Officer",
                "Chief People Officer",
                "Chief HR Officer",
                "Chief Talent Officer",
                "Chief Employee Experience Officer",
                "Chief People and Culture Officer",
                "Chief Diversity Officer",
                "Chief Learning Officer",
                "Chief Organizational Development Officer",
                "Chief Happiness Officer",
                "Chief Talent Acquisition Officer",
                "Chief HR Strategist",
                "Chief Employee Relations Officer",
                "Chief Talent Management Officer",
                "Chief Compensation and Benefits Officer",
                "Chief Workforce Planning Officer",
                "Chief HR Technology Officer",
                "Chief HR Analytics Officer",
                "Chief Employee Wellness Officer",
                "Chief Talent Branding Officer",
                "Chief Learning and Development Officer",
                "Chief Change Management Officer",
                "Chief Employee Engagement Officer",
                "Chief Employee Communications Officer",
                "Chief HR Transformation Officer",
                "Chief People Analytics Officer",
                "Chief Employee Experience Strategist",
                "Chief People and Culture Strategist",
                "Chief Diversity and Inclusion Strategist",
                "Chief Learning and Development Strategist",
                "Chief Organizational Development Strategist",
                "Chief HR Strategist",
                "Chief Employee Relations Strategist",
                "Chief Talent Management Strategist",
                "Chief Compensation and Benefits Strategist",
                "Chief Workforce Planning Strategist",
                "Chief HR Technology Strategist",
                "Chief HR Analytics Strategist",
                "Chief Employee Wellness Strategist",
                "Chief Talent Branding Strategist",
                "Chief Learning and Development Strategist",
                "Chief Change Management Strategist",
                "Chief Employee Engagement Strategist",
                "Chief Employee Communications Strategist",
                "Chief HR Transformation Strategist",
                "Chief People Analytics Strategist",
                "Chief Employee Experience Director",
                "Chief People and Culture Director",
                "Chief Diversity Director",
                "Chief Learning and Development Director",
                "Chief Organizational Development Director",
                "Chief HR Director",
                "Chief Employee Relations Director",
                "Chief Talent Management Director",
                "Chief Compensation and Benefits Director",
                "Chief Workforce Planning Director",
                "Chief HR Technology Director",
                "Chief HR Analytics Director",
                "Chief Employee Wellness Director",
                "Chief Talent Branding Director",
                "Chief Learning and Development Director",
                "Chief Change Management Director",
                "Chief Employee Engagement Director",
                "Chief Employee Communications Director",
                "Chief HR Transformation Director",
                "Chief People Analytics Director",
                "Chief Employee Experience Manager",
                "Chief People and Culture Manager",
                "Chief Diversity Manager",
                "Chief Learning and Development Manager",
                "Chief Organizational Development Manager",
                "Chief HR Manager",
                "Chief Employee Relations Manager",
                "Chief Talent Management Manager",
                "Chief Compensation and Benefits Manager",
                "Chief Workforce Planning Manager",
                "Chief HR Technology Manager",
                "Chief HR Analytics Manager",
                "Chief Employee Wellness Manager",
                "Chief Talent Branding Manager",
                "Chief Learning and Development Manager",
                "Chief Change Management Manager",
                "Chief Employee Engagement Manager",
                "Chief Employee Communications Manager",
                "Chief HR Transformation Manager",
                "Chief People Analytics Manager",
                "Chief Employee Experience Coordinator",
                "Chief People and Culture Coordinator",
                "Chief Diversity Coordinator",
                "Chief Learning and Development Coordinator",
                "Chief Organizational Development Coordinator",
                "Chief HR Coordinator",
                "Chief Employee Relations Coordinator",
                "Chief Talent Management Coordinator",
                "Chief Compensation and Benefits Coordinator",
                "Chief Workforce Planning Coordinator",
                "Chief HR Technology Coordinator",
                "Chief HR Analytics Coordinator",
                "Chief Employee"};


        for (int i = 0; i < professions1.length; i++) {
            String professionA = professions1[i];
            String professionB = professions2[i];
            String prompt1 = "Explain the top 5 skills required to be an outstanding " + professionA + " in about 500 words. Then paraphrase the entire 500 words while retaining the numbered points and the number of words." +
                    "Don't leave lines anywhere. If one point ends, start the next point from the very next line. Separate the original and paraphrase using a delimiter '=='.";

            String prompt2 = "Explain the top 5 skills required to be an outstanding " + professionB + " in about 500 words. Then paraphrase the entire 500 words while retaining the numbered points and the number of words." +
                    "Don't leave lines anywhere. If one point ends, start the next point from the very next line. Separate the original and paraphrase using a delimiter '=='.";
            try {
                String content1 = apiService.getChatCompletion(prompt1);
                log.info("Data retrieved for entry for profession " + professionA);
                String[] sections1 = content1.split("""
                        ==

                        """);
                DatasetObject datasetObject = new DatasetObject();
                datasetObject.setOriginalId(datasetService.storeOriginalParagraph(sections1[0]));
                log.info("saved original for " + professionA);
                datasetObject.setParaphraseId(datasetService.storeParaphrasedParagraph(sections1[1]));
                log.info("saved paraphrase for " + professionA);

                datasetRepo.save(datasetObject);
                x++;
                log.info("Dataset entry saved for profession " + professionA);
                log.info("Time elapsed: " + (System.currentTimeMillis() - startTime) / 1000);
                log.info("Dataset Entries Saved: " + x);


                String content2 = apiService2.getChatCompletion(prompt2);
                log.info("Data retrieved for entry for profession " + professionB);
                String[] sections2 = content2.split("""
                        ==

                        """);
                DatasetObject datasetObject2 = new DatasetObject();
                datasetObject2.setOriginalId(datasetService.storeOriginalParagraph(sections2[0]));
                log.info("saved original for " + professionB);
                datasetObject2.setParaphraseId(datasetService.storeParaphrasedParagraph(sections2[1]));
                log.info("saved paraphrase for " + professionB);

                datasetRepo.save(datasetObject2);
                x++;
                log.info("Dataset entry saved for profession " + professionB);
                log.info("Time elapsed: " + (System.currentTimeMillis() - startTime) / 1000);
                log.info("Dataset Entries Saved: " + x);

            } catch (Exception e) {
                log.error("Error occured while making api call.....");
                log.error(e.getMessage());
                log.info("moving to next profession...");
            }
        }
        long timeElapsed = System.currentTimeMillis() - startTime;
        log.info("Time taken to complete all professions : " + String.valueOf(timeElapsed / 1000) + " seconds.");
    }

    public void createDataset3(int num) {
        long startTime = System.currentTimeMillis();
        int x = 0;
        log.info("Dataset Creation process started....");
        String[] profession = {
                "Kombucha Brewer", "Lighthouse Keeper", "Metal Sculptor", "Nanotechnology Engineer", "Opera Singer",
                "Palliative Care Nurse", "Quantum Astrophysicist", "Robotics Technician", "Sound Effects Artist", "Taxidermy Supply Shop Owner",
                "Urban Explorer", "Virtual Reality Architect", "Wood Carver", "Xenophotographer", "Yoga Retreat Planner",
                "Zipline Course Designer", "Amusement Park Imagineer", "Brewery Tour Guide", "Crystal Healer", "Dungeon Master",
                "Eco-friendly Fashion Designer", "Foley Mixer", "Gemstone Cutter", "Harbor Master", "Interior Green Wall Designer",
                "Jewelry Metalsmith", "Kinetic Typographer", "Landscape Ecologist", "Music Therapist", "Nautical Archaeologist",
                "Oyster Farmer", "Puppetry Therapist", "Quantum Ethicist", "Railroad Engineer", "Safari Guide",
                "Taxidermy Veterinarian", "Underwater Cave Explorer", "Vocal Coach", "Wine Biodynamic Consultant", "Xerophyte Biologist",
                "Yacht Interior Designer", "Zen Meditation Instructor", "Alpaca Farmer", "Bionic Limb Designer", "Cryptocurrency Analyst",
                "Drones Operator", "Exoplanet Scientist", "Feng Shui Planner", "Galactic Historian", "Holographic Programmer",
                "Insect Farmer", "Jellyfish Biologist", "Kite Aerial Photographer", "Laser Show Designer", "Martial Arts Therapist",
                "Nuclear Fusion Engineer", "Optical Illusion Artist", "Pixel Artist", "Quantum Information Scientist", "Reiki Master",
                "Solar System Explorer", "Time Travel Theorist", "Underwater Robotics Engineer", "Virtual Reality Sound Engineer", "Wine Glass Artist",
                "Xylophonist", "Yoga Philosophy Teacher", "Zero Gravity Trainer", "Astrodynamics Engineer", "Bonsai Horticulturist",
                "Culinary Tour Guide", "Dream Therapist", "Environmental Graphic Designer", "Feng Shui Consultant", "Galactic Travel Agent",
                "Hybrid Car Engineer", "Ice Cream Flavor Inventor", "Jazz Saxophonist", "Kite Surfing Instructor", "Luthier Apprentice",
                "Nanoengineering Specialist", "Outdoor Adventure Guide", "Paleoanthropologist", "Quantum Neurologist", "Remote Sensing Scientist",
                "Sustainable Architect", "Tattoo Artist", "Ultrasonographer", "Venomous Snake Milker", "Wine Grape Geneticist",
                "X-ray Crystallographer", "Yoga Trapeze Instructor", "Zebra Trainer", "Astrological Counselor", "Brewpub Owner",
                "Cryptocurrency Trader", "Dog Surfing Instructor", "Equestrian Masseuse", "Foley Recordist", "Gemstone Geologist",
                "Heliophysicist", "Insect Taxidermy Instructor", "Jewelry Appraisal Specialist", "Kelp Forest Guide", "Linguistic Archaeologist",
                "Mushroom Forager", "Neon Sign Designer", "Olfactory Branding Specialist", "Piano Tuner", "Quantum Psychophysiologist",
                "Rocket Scientist", "Synchronized Swimmer", "Taxidermy Artisan", "Urbex Artist", "Virtual Reality Game Developer",
                "Wine Harvester", "Xenobotanical Researcher", "Yoga Anatomy Instructor", "Zipline Course Inspector", "Airship Pilot",
                "Biodiversity Conservationist", "Cocktail Historian", "Digital Nomad Coach", "Ethical Fashion Stylist", "Fire Lookout",
                "Glass Blowing Instructor", "Hypnosis Therapist", "Internet of Things (IoT) Developer", "Jazz Dance Instructor", "Kombucha Mixologist",
                "Linguistic Engineer", "Meteor Shower Chaser", "Noodle Artist", "Ornithologist", "Puppeteer Therapist",
                "Quantum Theorist", "Robotics Researcher", "Sound Healing Therapist", "Taxidermy Art Conservationist", "Underwater Basket Weaver",
                "Vocal Sound Engineer", "Wine Label Designer", "Xenozoologist", "Yoga Retreat Photographer", "Zipline Guide Trainer",
                "Amusement Park Ride Tester", "Brewmaster Apprentice", "Crystallographer", "Dungeon Master Event Planner", "Eco-friendly Product Designer",
                "Flower Arrangement Therapist", "Gemstone Inspector", "Harbor Master", "Interactive Exhibit Designer", "Jewelry Engraver",
                "Kinetic Sculpture Artist", "Landscape Photographer", "Music Festival Organizer", "Nature Sound Recordist", "Oyster Shucker",
                "Puppetry Workshop Facilitator", "Quantum Physicist", "Railroad Conductor", "Sailboat Captain", "Tea Blender",
                "Taxidermy Art Restoration Specialist", "Underwater Filmmaker", "Vocational Rehabilitation Counselor", "Wine Label Illustrator", "Xerophyte Horticulturist",
                "Yoga Studio Owner", "Zen Garden Designer", "Alpine Guide", "Bioplastics Engineer", "Cryptography Expert",
                "Drone Racing Pilot", "Exoplanet Hunter", "Feng Shui Consultant", "Galactic Tour Guide", "Holographic Artist",
                "Insect Behaviorist", "Jellyfish Bioluminescence Specialist", "Kite Designer", "Laser Safety Officer", "Material Scientist",
                "Nuclear Medicine Technologist", "Optical Illusion Specialist", "Pixel Art Animator", "Quantum Computing Engineer", "Reiki Practitioner",
                "Solar Technician", "Time Travel Historian", "Underwater Photographer", "Virtual Reality Cinematographer", "Wine Label Consultant",
                "Xenobotanist", "Yoga Therapist", "Zero Gravity Flight Instructor", "Astrodynamics Specialist", "Bonsai Master",
                "Culinary Historian", "Dream Analyst", "Environmental Economist", "Feng Shui Specialist", "Galactic Ethnographer",
                "Hydroponic Farmer", "Ice Carver", "Jazz Trombonist", "Kinetic Sculpture Designer", "Lucid Dream Therapist",
                "Meme Archivist", "Nanochemistry Researcher", "Ocular Prosthesis Technician", "Paper Engineer", "Quantum Chemistry Professor",
                "Recreational Therapist", "Solar Energy Consultant", "Taxidermy Art Restoration Specialist", "Underwater Welder", "Virtual Reality Filmmaker",
                "Wine Educator", "Xenobiological Engineer", "Yogurt Artisan", "Zen Gardener"
        };


        for (int i = 0; i < profession.length; i++) {
            String professionB = profession[i];
            String prompt2 = "Explain the top 5 skills required to be an outstanding " + professionB + " in about 500 words. Then paraphrase the entire 500 words while retaining the numbered points and the number of words." +
                    "Don't leave lines anywhere. If one point ends, start the next point from the very next line. Separate the original and paraphrase using a delimiter '=='.";
            String content2 = apiService2.getChatCompletion(prompt2);
            log.info("Data retrieved for entry for profession " + professionB);
            String[] sections2 = content2.split("""
                    ==

                    """);
            DatasetObject datasetObject2 = new DatasetObject();
            datasetObject2.setOriginalId(datasetService.storeOriginalParagraph(sections2[0]));
            log.info("saved original for " + professionB);
            datasetObject2.setParaphraseId(datasetService.storeParaphrasedParagraph(sections2[1]));
            log.info("saved paraphrase for " + professionB);

            datasetRepo.save(datasetObject2);
            x++;
            log.info("Dataset entry saved for profession " + professionB);
            log.info("Time elapsed: " + (System.currentTimeMillis() - startTime) / 1000);
            log.info("Dataset Entries Saved: " + x);
        }
    }

    public List<DatasetObject> listDatasetObjects() {
        List<DatasetObject> datasetIDS = datasetRepo.findAll(Sort.by("id").ascending());
        return datasetIDS;
    }

    public void exportToCsv(HttpServletResponseWrapper response) throws IOException {
        log.info("Download Process Started......");
        response.setContentType("text/csv");
        DateFormat dateFormatter = new SimpleDateFormat("yyyy-MM-dd_HH-mm-ss");
        String currentDateTime = dateFormatter.format(new Date());
        log.info("Date Set......");

        String headerKey = "Content-Disposition";
        String headerValue = "attachment; filename=dataset_" + currentDateTime + ".csv";
        log.info("Headers Set.....");

        response.setHeader(headerKey, headerValue);
        List<DatasetObject> datasetIDS = this.listDatasetObjects();

        ICsvBeanWriter csvWriter = new CsvBeanWriter(response.getWriter(), CsvPreference.STANDARD_PREFERENCE);
        log.info("Csv Writer created.......");

        String[] csvHeader = {"original", "paraphrase"};
        String[] nameMapping = {"original", "paraphrase"};
        log.info("Csv Headers Created.....");

        csvWriter.writeHeader(csvHeader);
        log.info("Csv Headers Written....");

        for (DatasetObject datasetObject : datasetIDS) {
            DatasetDto datasetDto = new DatasetDto();
            datasetDto.setOriginal(datasetService.retrieveOriginalParagraph(datasetObject.getOriginalId()));
            datasetDto.setParaphrase(datasetService.retrieveParaphrasedParagraph(datasetObject.getParaphraseId()));
            csvWriter.write(datasetDto, nameMapping);
        }
        log.info("Database Mapped and downloaded to csv file.");

        csvWriter.close();
    }
}


